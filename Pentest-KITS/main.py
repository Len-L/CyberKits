import subprocess as qq
import time

while True:
    print(" ")
    print("1. Scanning")
    print("2. SSRF")
    print("3. Bypass 403")
    print("4. Pencari Parameter [Mining URLS]")
    print("99. Exit")

    opsi = input("[Pentest-KITS]_Options-> ")
    print(" ")

    if opsi=="1":
        IP = input("Input IP-> ")
        qq.run(['nmap', '-sC', '-sV', IP, '-oA', 'scan'])
        with open("scan.nmap", "r") as f:
            data = f.read()
        if "Apache httpd 2.4.49" in data:
            print(" ")
            print("Vuln Traversal & RCE >>> 'Apache 2.4.49'")
            li = qq.run(["ls", "CVE"], capture_output=True).stdout.decode()
            if "apache-2.4.49" in li:
                print("Menemukan 1 Script Exploit")
                run = input("exploit sekarang? [y/n]-> ")
                if run=="y":
                    with open("target.txt", "w") as f:
                        f.write(IP + "\n")
                    while True:
                        print("-----------------------------------------")
                        print("Untuk Exit Type 'exit' ")
                        command = input("[Pentest-KITS/CVE-2021-41773]_Traversal-> ")
                        print("-----------------------------------------")
                        if command=="exit":
                            exit()
                        qq.run(["bash", "CVE/apache-2.4.49.sh", "target.txt", command])
                elif run=="n":
                    print(" ")
            else:
                print("Tidak Ada Script Exploit Untuk Vuln Ini")

        elif "Apache httpd 2.4.50" in data:
            print(" ")
            print("Vuln Traversal & RCE >>> 'Apache 2.4.50'")
            li = qq.run(["ls", "CVE"], capture_output=True).stdout.decode()
            if "apache-2.4.50" in li:
                print("Menemukan 1 Script Exploit")
                run = input("exploit sekarang? [y/n]-> ")
                if run=="y":
                    print("script exploit")
                elif run=="n":
                    print(" ")
            else:
                print("Tidak Ada Script Exploit Untuk Vuln Ini")
        else:
            print(" ")
            print("Tidak Rentan")
            print(" ")
        qq.run(['rm', 'scan.gnmap', 'scan.nmap', 'scan.xml'])

    elif opsi=="2":
        reqfile = input("Masukan Req File-> ")
        parameter = input("Masukan Parameter-> ")
        qq.run(['python3', 'ssrf/ssrf.py', '-r', reqfile, '-m', 'readfiles', '-p', parameter])

    elif opsi=="3":
        url = input("url-> ")
        path = input("path-> ")
        qq.run(['bash', 'bypass-403.sh', url, path])

    elif opsi=="4":
        domain = input("Masukan Domain-> ")
        qq.run(['python3', 'parameter.py', '-d', domain])








    elif opsi=="99":
        print(" ")
        print("Semoga Bermanfaat :) ")
        break

    else:
        print("Tolong masukan opsi sesuai angka yang ada")









